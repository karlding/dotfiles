#!/bin/bash

ROOT_DIR=$(pwd)
# source test helpers
cd "$(dirname "${BASH_SOURCE[0]}")" && source "utils.sh"
# go back to original directory
cd "${ROOT_DIR}"

EXIT_CODE=0

# main entry point
if [ "$(get_os)" == "macos" ]; then
    ./install macos || EXIT_CODE=1

    # rvm
    rvm get stable

    # brew
    brew update
    brew bundle || EXIT_CODE=1
elif [ "$(get_os)" == "ubuntu" ]; then
    ./install linux || EXIT_CODE=1
elif [ "$(get_os)" == "windows" ]; then
    echo "Windows has no tests"

    EXIT_CODE=1
else
    echo "[ERROR]: Unknown OS"
    get_os

    EXIT_CODE=1
fi
exit ${EXIT_CODE}
